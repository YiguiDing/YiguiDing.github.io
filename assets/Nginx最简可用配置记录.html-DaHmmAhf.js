import{_ as n,c as s,o as i,b as e}from"./app-DjDtDPYL.js";const a={},l=e(`<h1 id="nginx最简可用配置记录" tabindex="-1"><a class="header-anchor" href="#nginx最简可用配置记录"><span>Nginx最简可用配置记录</span></a></h1><blockquote><p>nginx version: nginx/1.22.1</p></blockquote><p><code>/etc/nginx/nginx.conf</code></p><div class="language-conf line-numbers-mode" data-highlighter="prismjs" data-ext="conf" data-title="conf"><pre><code><span class="line"># 什么都没改，默认配置</span>
<span class="line">user  nginx;</span>
<span class="line">worker_processes  auto;</span>
<span class="line"></span>
<span class="line">error_log  /var/log/nginx/error.log notice;</span>
<span class="line">pid        /var/run/nginx.pid;</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">events {</span>
<span class="line">    worker_connections  1024;</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">http {</span>
<span class="line">    include       /etc/nginx/mime.types;</span>
<span class="line">    default_type  application/octet-stream;</span>
<span class="line"></span>
<span class="line">    log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;</span>
<span class="line">                      &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span>
<span class="line">                      &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;</span>
<span class="line"></span>
<span class="line">    access_log  /var/log/nginx/access.log  main;</span>
<span class="line"></span>
<span class="line">    sendfile        on;</span>
<span class="line">    #tcp_nopush     on;</span>
<span class="line"></span>
<span class="line">    keepalive_timeout  65;</span>
<span class="line"></span>
<span class="line">    #gzip  on; # gzip 其实可以启用</span>
<span class="line"></span>
<span class="line">    include /etc/nginx/conf.d/*.conf;# 这里就是引入default.conf配置文件</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>/etc/nginx/conf.d/default.conf</code></p><div class="language-conf line-numbers-mode" data-highlighter="prismjs" data-ext="conf" data-title="conf"><pre><code><span class="line"># 所有http协议的请求全部重定向为https请求</span>
<span class="line">server{</span>
<span class="line">    listen 80;</span>
<span class="line">    #（第一种）把http的域名请求转成https</span>
<span class="line">    #return 301 https://$host$request_uri;</span>
<span class="line">    #（第二种）强制将http://\${server_name配置}的URL重写成https</span>
<span class="line">    # server_name ???.???.???;</span>
<span class="line">    # rewrite ^(.*) https://\${server_name}$1 permanent;</span>
<span class="line">    #（第三种）强制将http://\${请求的host}的URL重写成https</span>
<span class="line">    rewrite ^(.*) https://$host$1 permanent; </span>
<span class="line">}</span>
<span class="line"># for blog</span>
<span class="line">server{</span>
<span class="line">    # # listen 80; #  监听80端口 默认http协议</span>
<span class="line">    listen 443 ssl; # 监听443端口 ssl表示https协议</span>
<span class="line">    server_name dingdingdang.online www.dingdingdang.online; # 域名，可填写多个</span>
<span class="line">    ssl_certificate     ssl/dingdingdang.online.pem;# 证书，表示放在/etc/nginx/ssl/ 目录下</span>
<span class="line">    ssl_certificate_key ssl/dingdingdang.online.key;</span>
<span class="line">    ssl_protocols       TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</span>
<span class="line">    ssl_ciphers         HIGH:!aNULL:!MD5;</span>
<span class="line">    location / {</span>
<span class="line">        root /var/www/blog;// 网站根目录，要注意目录的权限</span>
<span class="line">        index index index.html index.htm;// 主页</span>
<span class="line">    }</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"># for file server</span>
<span class="line">server{</span>
<span class="line">    # listen 80;</span>
<span class="line">    listen 443 ssl;</span>
<span class="line">    server_name file.dingdingdang.online; </span>
<span class="line">    ssl_certificate     ssl/file.dingdingdang.online.pem;</span>
<span class="line">    ssl_certificate_key ssl/file.dingdingdang.online.key;</span>
<span class="line">    ssl_protocols       TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</span>
<span class="line">    ssl_ciphers         HIGH:!aNULL:!MD5;</span>
<span class="line">    location / {</span>
<span class="line">        proxy_pass http://127.0.0.1:8081;// 单纯重定向</span>
<span class="line">    }</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"># -----------------------------start:for vscode and vscode&#39;s wss--------------------------------------</span>
<span class="line"></span>
<span class="line"># 因为 code-server 不仅需要代理 http://127.0.0.1:8080 还需要 代理ws://127.0.0.1:8080</span>
<span class="line">map $http_upgrade $connection_upgrade {# map</span>
<span class="line">    default upgrade;</span>
<span class="line">    &#39;&#39; close;</span>
<span class="line">}</span>
<span class="line">server{</span>
<span class="line">    # listen 80;</span>
<span class="line">    listen 443 ssl;</span>
<span class="line">    server_name code.dingdingdang.online; </span>
<span class="line">    ssl_certificate     ssl/code.dingdingdang.online.pem;</span>
<span class="line">    ssl_certificate_key ssl/code.dingdingdang.online.key;</span>
<span class="line">    ssl_protocols       TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</span>
<span class="line">    ssl_ciphers         HIGH:!aNULL:!MD5;</span>
<span class="line"></span>
<span class="line">    location / {</span>
<span class="line">        proxy_pass http://127.0.0.1:8080;</span>
<span class="line">        # 下面的部分就是使其支持wss://127.0.0.1:8080</span>
<span class="line">        proxy_http_version 1.1;</span>
<span class="line">        proxy_pass_header Server;</span>
<span class="line">        proxy_set_header Host $http_host;</span>
<span class="line">        proxy_set_header X-Real-IP $remote_addr;</span>
<span class="line">        proxy_set_header X-Forwarded-Proto $scheme;</span>
<span class="line">        proxy_set_header Connection $connection_upgrade;</span>
<span class="line">        proxy_set_header Upgrade $http_upgrade;</span>
<span class="line">    }</span>
<span class="line">}</span>
<span class="line"># -----------------------------end:for vscode and vscode&#39;s wss--------------------------------------</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"># 代理</span>
<span class="line"># for google</span>
<span class="line">server{</span>
<span class="line">    # listen 80;</span>
<span class="line">    listen 443 ssl;</span>
<span class="line">    server_name google.dingdingdang.online; </span>
<span class="line">    ssl_certificate     ssl/dingdingdang.online.pem;</span>
<span class="line">    ssl_certificate_key ssl/dingdingdang.online.key;</span>
<span class="line">    ssl_protocols       TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</span>
<span class="line">    ssl_ciphers         HIGH:!aNULL:!MD5;</span>
<span class="line">    location / {</span>
<span class="line">        proxy_pass https://www.google.com/;</span>
<span class="line">    }</span>
<span class="line">}</span>
<span class="line"># for github</span>
<span class="line">server{</span>
<span class="line">    # listen 80;</span>
<span class="line">    listen 443 ssl;</span>
<span class="line">    server_name github.dingdingdang.online; </span>
<span class="line">    ssl_certificate     ssl/dingdingdang.online.pem;</span>
<span class="line">    ssl_certificate_key ssl/dingdingdang.online.key;</span>
<span class="line">    ssl_protocols       TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</span>
<span class="line">    ssl_ciphers         HIGH:!aNULL:!MD5;</span>
<span class="line">    location / {</span>
<span class="line">        proxy_pass https://github.com/;</span>
<span class="line">    }</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line"># 以下为默认配置</span>
<span class="line"># server {</span>
<span class="line">#     listen       80;</span>
<span class="line">#     server_name  localhost;</span>
<span class="line"></span>
<span class="line">#     #access_log  /var/log/nginx/host.access.log  main;</span>
<span class="line"></span>
<span class="line">#     location / {</span>
<span class="line">#         root   /usr/share/nginx/html;</span>
<span class="line">#         index  index.html index.htm;</span>
<span class="line">#     }</span>
<span class="line"></span>
<span class="line">#     #error_page  404              /404.html;</span>
<span class="line"></span>
<span class="line">#     # redirect server error pages to the static page /50x.html</span>
<span class="line">#     #</span>
<span class="line">#     error_page   500 502 503 504  /50x.html;</span>
<span class="line">#     location = /50x.html {</span>
<span class="line">#         root   /usr/share/nginx/html;</span>
<span class="line">#     }</span>
<span class="line"></span>
<span class="line">#     # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span>
<span class="line">#     #</span>
<span class="line">#     #location ~ \\.php$ {</span>
<span class="line">#     #    proxy_pass   http://127.0.0.1;</span>
<span class="line">#     #}</span>
<span class="line"></span>
<span class="line">#     # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span>
<span class="line">#     #</span>
<span class="line">#     #location ~ \\.php$ {</span>
<span class="line">#     #    root           html;</span>
<span class="line">#     #    fastcgi_pass   127.0.0.1:9000;</span>
<span class="line">#     #    fastcgi_index  index.php;</span>
<span class="line">#     #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span>
<span class="line">#     #    include        fastcgi_params;</span>
<span class="line">#     #}</span>
<span class="line"></span>
<span class="line">#     # deny access to .htaccess files, if Apache&#39;s document root</span>
<span class="line">#     # concurs with nginx&#39;s one</span>
<span class="line">#     #</span>
<span class="line">#     #location ~ /\\.ht {</span>
<span class="line">#     #    deny  all;</span>
<span class="line">#     #}</span>
<span class="line"># }</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),c=[l];function d(p,r){return i(),s("div",null,c)}const t=n(a,[["render",d],["__file","Nginx最简可用配置记录.html.vue"]]),o=JSON.parse('{"path":"/%E5%90%8E%E7%AB%AF/Nginx%E6%9C%80%E7%AE%80%E5%8F%AF%E7%94%A8%E9%85%8D%E7%BD%AE%E8%AE%B0%E5%BD%95/Nginx%E6%9C%80%E7%AE%80%E5%8F%AF%E7%94%A8%E9%85%8D%E7%BD%AE%E8%AE%B0%E5%BD%95.html","title":"Nginx最简可用配置记录","lang":"zh-CN","frontmatter":{"date":"2023-04-04T04:33:00.000Z","title":"Nginx最简可用配置记录","cover":"./cover/default_cover.jpg","tag":["express"],"category":"后端","description":"Nginx最简可用配置记录 nginx version: nginx/1.22.1 /etc/nginx/nginx.conf /etc/nginx/conf.d/default.conf","head":[["meta",{"property":"og:url","content":"https://dingdingdang.online/%E5%90%8E%E7%AB%AF/Nginx%E6%9C%80%E7%AE%80%E5%8F%AF%E7%94%A8%E9%85%8D%E7%BD%AE%E8%AE%B0%E5%BD%95/Nginx%E6%9C%80%E7%AE%80%E5%8F%AF%E7%94%A8%E9%85%8D%E7%BD%AE%E8%AE%B0%E5%BD%95.html"}],["meta",{"property":"og:site_name","content":"YiguiDing的Blog小站"}],["meta",{"property":"og:title","content":"Nginx最简可用配置记录"}],["meta",{"property":"og:description","content":"Nginx最简可用配置记录 nginx version: nginx/1.22.1 /etc/nginx/nginx.conf /etc/nginx/conf.d/default.conf"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-11-17T13:06:31.000Z"}],["meta",{"property":"article:author","content":"丁毅桂"}],["meta",{"property":"article:tag","content":"express"}],["meta",{"property":"article:published_time","content":"2023-04-04T04:33:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-11-17T13:06:31.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Nginx最简可用配置记录\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-04-04T04:33:00.000Z\\",\\"dateModified\\":\\"2023-11-17T13:06:31.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"丁毅桂\\",\\"email\\":\\"2449695354@qq.com\\"}]}"],["meta",{"name":"baidu-site-verification","content":"codeva-PwE9Ts6nMl"}]]},"headers":[],"git":{"createdTime":1700226391000,"updatedTime":1700226391000,"contributors":[{"name":"YiguiDing","email":"2449695354@qq.com","commits":1}]},"readingTime":{"minutes":1.99,"words":597},"filePathRelative":"后端/Nginx最简可用配置记录/Nginx最简可用配置记录.md","localizedDate":"2023年4月4日","excerpt":"","autoDesc":true}');export{t as comp,o as data};
