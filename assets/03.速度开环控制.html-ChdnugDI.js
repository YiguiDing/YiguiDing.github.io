import{_ as o,c,d as p,w as a,a as n,r as i,o as u,e as s}from"./app-CWj8XoYb.js";const r={},k=n("h2",{id:"速度开环控制的实现",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#速度开环控制的实现"},[n("span",null,"速度开环控制的实现")])],-1),d=n("code",null,"FOC.c",-1),m=n("code",null,"FOC.h",-1),v=n("div",{class:"language-cpp line-numbers-mode","data-highlighter":"prismjs","data-ext":"cpp","data-title":"cpp"},[n("pre",null,[n("code",null,[n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"include"),s(),n("span",{class:"token string"},'"FOC.h"')])]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"float"),s(" max_power_supply_voltage "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"12"),n("span",{class:"token punctuation"},";"),s(),n("span",{class:"token comment"},"// 供电电压")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"float"),s(" limit_voltage "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"5"),n("span",{class:"token punctuation"},";"),s("             "),n("span",{class:"token comment"},"// 供电电压")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"uint8_t"),s(" pole_pairs "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"7"),n("span",{class:"token punctuation"},";"),s("              "),n("span",{class:"token comment"},"// 极对数")]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token function"},"FOC_Init"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token function"},"Timer2_PWM_Init"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token function"},"Timer2_PWM_SetFreq"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"70"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token function"},"RTC_Time_Init"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token function"},"OLED_Init"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token comment"},"/**"),s(`
`),n("span",{class:"line"}," * @param uD 施加在D轴的电压 范围 [-max,+max]"),s(`
`),n("span",{class:"line"}," * @param uQ 施加在Q轴的电压 范围 [-max,+max]"),s(`
`),n("span",{class:"line"}," * @param angle 机械角度 单位：弧度制 因为标准库中的sin函数也是弧度制"),s(`
`),n("span",{class:"line"}," */")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token function"},"FOC_ControlUpdate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" uD"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"float"),s(" uQ"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"float"),s(" angle"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token comment"},"// 限制电压范围")]),s(`
`),n("span",{class:"line"},[s("    uD "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"fixedRange"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"-"),s("max_power_supply_voltage"),n("span",{class:"token punctuation"},","),s(" uD"),n("span",{class:"token punctuation"},","),s(" max_power_supply_voltage"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    uQ "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"fixedRange"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"-"),s("max_power_supply_voltage"),n("span",{class:"token punctuation"},","),s(" uQ"),n("span",{class:"token punctuation"},","),s(" max_power_supply_voltage"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token comment"},"// 通过机械角度计算电角度")]),s(`
`),n("span",{class:"line"},[s("    angle "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"normalizeAngle"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"electricalAngle"),n("span",{class:"token punctuation"},"("),s("angle"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token comment"},"// 帕克变换")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"float"),s(" uAlpha "),n("span",{class:"token operator"},"="),s(" uD "),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token function"},"cos"),n("span",{class:"token punctuation"},"("),s("angle"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"-"),s(" uQ "),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token function"},"sin"),n("span",{class:"token punctuation"},"("),s("angle"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"float"),s(" uBata "),n("span",{class:"token operator"},"="),s(" uQ "),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token function"},"cos"),n("span",{class:"token punctuation"},"("),s("angle"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"+"),s(" uD "),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token function"},"sin"),n("span",{class:"token punctuation"},"("),s("angle"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token comment"},"// 克拉克逆变换（等幅值）")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"float"),s(" uA "),n("span",{class:"token operator"},"="),s(" uAlpha"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"float"),s(" uB "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"sqrt"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"3"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"*"),s(" uBata "),n("span",{class:"token operator"},"-"),s(" uAlpha"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"/"),s(),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"float"),s(" uC "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"-"),s("uAlpha "),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token function"},"sqrt"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"3"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"*"),s(" uBata"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"/"),s(),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token comment"},"// 设置相电压")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token function"},"FOC_setPhaseVoltage"),n("span",{class:"token punctuation"},"("),s("uA"),n("span",{class:"token punctuation"},","),s(" uB"),n("span",{class:"token punctuation"},","),s(" uC"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token comment"},"/**"),s(`
`),n("span",{class:"line"}," * @param uA 施加在A相的电压 范围 [-max,+max]"),s(`
`),n("span",{class:"line"}," * @param uB 施加在B相的电压 范围 [-max,+max]"),s(`
`),n("span",{class:"line"}," * @param uC 施加在C相的电压 范围 [-max,+max]"),s(`
`),n("span",{class:"line"}," */")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token function"},"FOC_setPhaseVoltage"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" uA"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"float"),s(" uB"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"float"),s(" uC"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token comment"},"// 限制电压范围")]),s(`
`),n("span",{class:"line"},[s("    uA "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"fixedRange"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"-"),s("limit_voltage"),n("span",{class:"token punctuation"},","),s(" uA"),n("span",{class:"token punctuation"},","),s(" limit_voltage"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    uB "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"fixedRange"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"-"),s("limit_voltage"),n("span",{class:"token punctuation"},","),s(" uB"),n("span",{class:"token punctuation"},","),s(" limit_voltage"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    uC "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"fixedRange"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"-"),s("limit_voltage"),n("span",{class:"token punctuation"},","),s(" uC"),n("span",{class:"token punctuation"},","),s(" limit_voltage"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token function"},"Timer2_PWM_SetDuty"),n("span",{class:"token punctuation"},"(")]),s(`
`),n("span",{class:"line"},[s("        "),n("span",{class:"token comment"},"// 重映射 [-max,+max] => [0,1]")]),s(`
`),n("span",{class:"line"},[s("        uA "),n("span",{class:"token operator"},"/"),s(),n("span",{class:"token number"},"2"),s(),n("span",{class:"token operator"},"/"),s(" max_power_supply_voltage "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"0.5"),n("span",{class:"token punctuation"},",")]),s(`
`),n("span",{class:"line"},[s("        uB "),n("span",{class:"token operator"},"/"),s(),n("span",{class:"token number"},"2"),s(),n("span",{class:"token operator"},"/"),s(" max_power_supply_voltage "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"0.5"),n("span",{class:"token punctuation"},",")]),s(`
`),n("span",{class:"line"},[s("        uC "),n("span",{class:"token operator"},"/"),s(),n("span",{class:"token number"},"2"),s(),n("span",{class:"token operator"},"/"),s(" max_power_supply_voltage "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"0.5"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token comment"},"/**"),s(`
`),n("span",{class:"line"}," * 速度开环控制"),s(`
`),n("span",{class:"line"}," * @param targetSpeed 目标速度"),s(`
`),n("span",{class:"line"}," */")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token function"},"FOC_SpeedOpenLoopControl"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" targetSpeed"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"float"),s(" angle "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"float"),s(" dt_s"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"uint64_t"),s(" prevTime_ms"),n("span",{class:"token punctuation"},","),s(" curTime_ms"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    curTime_ms "),n("span",{class:"token operator"},"="),s(" prevTime_ms "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"RTC_Time_GetTime_MS"),n("span",{class:"token punctuation"},"("),n("span",{class:"token constant"},"NULL"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"while"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("        curTime_ms "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"RTC_Time_GetTime_MS"),n("span",{class:"token punctuation"},"("),n("span",{class:"token constant"},"NULL"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("        dt_s "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),s("curTime_ms "),n("span",{class:"token operator"},"-"),s(" prevTime_ms"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"/"),s(),n("span",{class:"token number"},"1000.0"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("        angle "),n("span",{class:"token operator"},"+="),s(" targetSpeed "),n("span",{class:"token operator"},"*"),s(" dt_s"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("        angle "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"normalizeAngle"),n("span",{class:"token punctuation"},"("),s("angle"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("        "),n("span",{class:"token function"},"FOC_ControlUpdate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},","),s(" limit_voltage"),n("span",{class:"token punctuation"},","),s(" angle"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("        prevTime_ms "),n("span",{class:"token operator"},"="),s(" curTime_ms"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token comment"},"/**"),s(`
`),n("span",{class:"line"}," * 范围限制"),s(`
`),n("span",{class:"line"}," */")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"float"),s(),n("span",{class:"token function"},"fixedRange"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" min"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"float"),s(" val"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"float"),s(" max"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"return"),s(" val "),n("span",{class:"token operator"},"<="),s(" min "),n("span",{class:"token operator"},"?"),s(" min "),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"("),s("val "),n("span",{class:"token operator"},">="),s(" max "),n("span",{class:"token operator"},"?"),s(" max "),n("span",{class:"token operator"},":"),s(" val"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token comment"},"/**"),s(`
`),n("span",{class:"line"}," * 将角度限制在[0,2π]"),s(`
`),n("span",{class:"line"}," */")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"float"),s(),n("span",{class:"token function"},"normalizeAngle"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" angle"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    angle "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"fmod"),n("span",{class:"token punctuation"},"("),s("angle"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"2"),s(),n("span",{class:"token operator"},"*"),s(" M_PI"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("angle "),n("span",{class:"token operator"},"<"),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[s("        angle "),n("span",{class:"token operator"},"+="),s(),n("span",{class:"token number"},"2"),s(),n("span",{class:"token operator"},"*"),s(" M_PI"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"return"),s(" angle"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token comment"},"/**"),s(`
`),n("span",{class:"line"}," * 电角度=机械角度 x 极对数"),s(`
`),n("span",{class:"line"}," */")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"float"),s(),n("span",{class:"token function"},"electricalAngle"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" mechanical_angle"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"return"),s(" mechanical_angle "),n("span",{class:"token operator"},"*"),s(" pole_pairs"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"float"),s(),n("span",{class:"token function"},"rad"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" deg"),n("span",{class:"token punctuation"},")")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"return"),s(" deg "),n("span",{class:"token operator"},"/"),s(),n("span",{class:"token number"},"180"),s(),n("span",{class:"token operator"},"*"),s(" M_PI"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"})])]),n("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),b=n("div",{class:"language-cpp line-numbers-mode","data-highlighter":"prismjs","data-ext":"cpp","data-title":"cpp"},[n("pre",null,[n("code",null,[n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"ifndef"),s(),n("span",{class:"token expression"},"__FOC_H__")])]),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"define"),s(),n("span",{class:"token macro-name"},"__FOC_H__")])]),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"include"),s(),n("span",{class:"token string"},'"stm32f10x.h"')])]),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"include"),s(),n("span",{class:"token string"},'"Timer2_PWM.h"')])]),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"include"),s(),n("span",{class:"token string"},'"RTC_Time.h"')])]),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"include"),s(),n("span",{class:"token string"},'"Delay.h"')])]),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"include"),s(),n("span",{class:"token string"},'"OLED.h"')])]),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"include"),s(),n("span",{class:"token string"},'"OLED_Printf.h"')])]),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"include"),s(),n("span",{class:"token string"},"<math.h>")])]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"ifdef"),s(),n("span",{class:"token expression"},"__cplusplus")])]),s(`
`),n("span",{class:"line"},[n("span",{class:"token keyword"},"extern"),s(),n("span",{class:"token string"},'"C"')]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"{")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"endif")])]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token function"},"FOC_Init"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token function"},"FOC_ControlUpdate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" uD"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"float"),s(" uQ"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"float"),s(" angle"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token function"},"FOC_setPhaseVoltage"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" uA"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"float"),s(" uB"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"float"),s(" uC"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token function"},"FOC_SpeedOpenLoopControl"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" targetSpeed"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"float"),s(),n("span",{class:"token function"},"fixedRange"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" min"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"float"),s(" val"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"float"),s(" max"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"float"),s(),n("span",{class:"token function"},"normalizeAngle"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" angle"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"float"),s(),n("span",{class:"token function"},"electricalAngle"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" mechanical_angle"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[s("    "),n("span",{class:"token keyword"},"float"),s(),n("span",{class:"token function"},"rad"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"float"),s(" deg"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"ifdef"),s(),n("span",{class:"token expression"},"__cplusplus")])]),s(`
`),n("span",{class:"line"},[n("span",{class:"token punctuation"},"}")]),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"endif")])]),s(`
`),n("span",{class:"line"}),s(`
`),n("span",{class:"line"},[n("span",{class:"token macro property"},[n("span",{class:"token directive-hash"},"#"),n("span",{class:"token directive keyword"},"endif")])]),s(`
`),n("span",{class:"line"})])]),n("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1);function _(f,y){const l=i("CodeTabs");return u(),c("div",null,[k,p(l,{id:"3",data:[{id:"<code v-pre>FOC.c</code>"},{id:"<code v-pre>FOC.h</code>"}]},{title0:a(({value:e,isActive:t})=>[d]),title1:a(({value:e,isActive:t})=>[m]),tab0:a(({value:e,isActive:t})=>[v]),tab1:a(({value:e,isActive:t})=>[b]),_:1})])}const w=o(r,[["render",_],["__file","03.速度开环控制.html.vue"]]),h=JSON.parse('{"path":"/%E7%94%B5%E5%AD%90/FOC%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%AE%9E%E7%8E%B0%E7%AC%94%E8%AE%B0/03.%E9%80%9F%E5%BA%A6%E5%BC%80%E7%8E%AF%E6%8E%A7%E5%88%B6.html","title":"FOC算法学习与实现笔记-03.速度开环控制","lang":"zh-CN","frontmatter":{"title":"FOC算法学习与实现笔记-03.速度开环控制","shortTitle":"03.速度开环控制","date":"2024-08-04T21:54:00.000Z","article":false,"index":true,"order":3,"description":"速度开环控制的实现","head":[["meta",{"property":"og:url","content":"https://dingdingdang.online/%E7%94%B5%E5%AD%90/FOC%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%AE%9E%E7%8E%B0%E7%AC%94%E8%AE%B0/03.%E9%80%9F%E5%BA%A6%E5%BC%80%E7%8E%AF%E6%8E%A7%E5%88%B6.html"}],["meta",{"property":"og:site_name","content":"YiguiDing的Blog小站"}],["meta",{"property":"og:title","content":"FOC算法学习与实现笔记-03.速度开环控制"}],["meta",{"property":"og:description","content":"速度开环控制的实现"}],["meta",{"property":"og:type","content":"website"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-12-02T13:48:43.000Z"}],["meta",{"property":"article:author","content":"丁毅桂"}],["meta",{"property":"article:published_time","content":"2024-08-04T21:54:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-12-02T13:48:43.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"WebPage\\",\\"name\\":\\"FOC算法学习与实现笔记-03.速度开环控制\\",\\"description\\":\\"速度开环控制的实现\\"}"],["meta",{"name":"baidu-site-verification","content":"codeva-PwE9Ts6nMl"}]]},"headers":[{"level":2,"title":"速度开环控制的实现","slug":"速度开环控制的实现","link":"#速度开环控制的实现","children":[]}],"git":{"createdTime":1722779729000,"updatedTime":1733147323000,"contributors":[{"name":"YiguiDing","email":"2449695354@qq.com","commits":3}]},"readingTime":{"minutes":0.2,"words":61},"filePathRelative":"电子/FOC算法学习与实现笔记/03.速度开环控制.md","localizedDate":"2024年8月4日","excerpt":"","autoDesc":true}');export{w as comp,h as data};
