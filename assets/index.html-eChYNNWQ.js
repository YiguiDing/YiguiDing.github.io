import{_ as i,c as a,e as n,o as l}from"./app-miCOOXrM.js";const e="/assets/image-BgWh_IE7.png",t="/assets/image2-BcqzzwnX.png",h={};function k(p,s){return l(),a("div",null,s[0]||(s[0]=[n(`<h1 id="使用workflows实现对vuepress的一键部署" tabindex="-1"><a class="header-anchor" href="#使用workflows实现对vuepress的一键部署"><span>使用workflows实现对vuepress的一键部署</span></a></h1><p><strong>服务端配置记录</strong></p><p><strong>创建git用户</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#4c4f69;--shiki-dark:#E6E6E6;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#222222;"><pre class="shiki shiki-themes catppuccin-latte slack-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># 创建一个用户</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">adduser</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> git</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># 切换到git用户</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">su</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> git</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># 初始化仓库</span></span>
<span class="line"><span style="--shiki-light:#D20F39;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">cd</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> /var/www/vuepress2-blog-root/</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">git</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> init</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># 创建分支</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">git</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> branch</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> static-pages</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># 允许提交代码到该目录</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">git</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> config</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> --global</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> --add</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> safe.directory</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> /var/www/vuepress2-blog-root/</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># 允许提交代码到当前分支</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">git</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> config</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> --global</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> --add</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> receive.denyCurrentBranch</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> ignore</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>为github的主机生成私钥和公钥</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#4c4f69;--shiki-dark:#E6E6E6;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#222222;"><pre class="shiki shiki-themes catppuccin-latte slack-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># 为github的主机生成私钥</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">ssh-keygen</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> -t</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> rsa</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># Generating public/private rsa key pair.</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># Enter file in which to save the key (/home/git/.ssh/id_rsa): ./github-action</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># Enter passphrase (empty for no passphrase): </span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># Enter same passphrase again: </span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># Your identification has been saved in ./github-action</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># Your public key has been saved in ./github-action.pub</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">ls</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># github-action  github-action.pub</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># 查看私钥</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">cat</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> github-action</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># 查看公钥</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">cat</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> github-action.pub</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># 将公钥内容附加到已授权的主机列表</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">cat</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> github-action.pub</span><span style="--shiki-light:#179299;--shiki-dark:#D4D4D4;"> &gt;&gt;</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> ~/.ssh/authorized_keys</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>在github的仓库创建私钥变量</strong></p><p>变量 名为 <code>SSH_PRIVATE_KEY</code> 值为 刚刚生成的私钥内容</p><p><img src="`+e+`" alt="Alt text"></p><p><strong>编写workflows配置文件</strong></p><blockquote><ul><li>此时在该配置文件中就能通过，<code>\${{ secrets.SSH_PRIVATE_KEY }}</code> 获取到配置的私钥地址，</li><li>然后由于已经将其公钥添加到了自己的服务器中，所以github的服务器就能和自己的服务器建立免密链接</li></ul></blockquote><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" style="--shiki-light:#4c4f69;--shiki-dark:#E6E6E6;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#222222;"><pre class="shiki shiki-themes catppuccin-latte slack-dark vp-code"><code class="language-yml"><span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> Deploy blog</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#FE640B;--shiki-dark:#569CD6;">on</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">  push</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">    branches</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;">      -</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> master</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">permissions</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">  contents</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> write</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">  pages</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> write</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">  id-token</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> write</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">jobs</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">  build-static-pages</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">    runs-on</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">    steps</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;">      -</span><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;"> name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> Checkout</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        uses</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> actions/checkout@v4</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        with</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">          submodules</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#FE640B;--shiki-dark:#569CD6;"> true</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">          fetch-depth</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#FE640B;--shiki-dark:#B5CEA8;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;">      -</span><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;"> name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> Setup Node.js</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        uses</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> actions/setup-node@v4</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        with</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">          node-version</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#FE640B;--shiki-dark:#B5CEA8;"> 18</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">          cache</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> npm</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;">      -</span><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;"> name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> Build Blog</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        run</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#8839EF;--shiki-dark:#C586C0;"> |</span></span>
<span class="line"><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;">          npm install</span></span>
<span class="line"><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;">          npm run build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;">      -</span><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;"> name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> Deploy</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        uses</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> JamesIves/github-pages-deploy-action@v4</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        with</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;">          # 将目录下代码推送到某个分支</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">          folder</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> blog/.vuepress/dist</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">          branch</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> static-pages</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">  deploy-to-github-pages</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">    needs</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> build-static-pages</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">    runs-on</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">    environment</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">      name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> github-pages</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;">      # https://YiguiDing.github.io/</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">      url</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> \${{ steps.deployment.outputs.page_url }}</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">    steps</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;">      -</span><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;"> name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> Checkout</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        uses</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> actions/checkout@v4</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        with</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">          ref</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> static-pages</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">          fetch-depth</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#FE640B;--shiki-dark:#B5CEA8;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;">      -</span><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;"> name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> Setup Pages</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        uses</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> actions/configure-pages@v3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;">      -</span><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;"> name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> Upload artifact</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        uses</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> actions/upload-pages-artifact@v2</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        with</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;">          # Upload entire repository</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">          path</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> &#39;./&#39;</span></span>
<span class="line"><span style="--shiki-light:#4C4F69;--shiki-dark:#E6E6E6;">          </span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;">      -</span><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;"> name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> Deploy to GitHub Pages</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        id</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> deployment</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        uses</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> actions/deploy-pages@v2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">  deploy-to-server</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">    needs</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> build-static-pages</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">    runs-on</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">    steps</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;">      -</span><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;"> name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> Checkout</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        uses</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> actions/checkout@v4</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        with</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">          ref</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> static-pages</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">          fetch-depth</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#FE640B;--shiki-dark:#B5CEA8;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;">      -</span><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;"> name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> Configuration environment</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        uses</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> webfactory/ssh-agent@v0.8.0</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        with</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">          ssh-private-key</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> \${{ secrets.SSH_PRIVATE_KEY }}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;">      -</span><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;"> name</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> Deploy</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-dark:#569CD6;">        run</span><span style="--shiki-light:#179299;--shiki-dark:#E6E6E6;">:</span><span style="--shiki-light:#8839EF;--shiki-dark:#C586C0;"> |</span></span>
<span class="line"><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;">          ssh-keyscan dingdingdang.online &gt;&gt; ~/.ssh/known_hosts</span></span>
<span class="line"><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;">          git config --global user.name &#39;YiguiDing&#39;</span></span>
<span class="line"><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;">          git config --global user.email &#39;2449695354@qq.com&#39;</span></span>
<span class="line"><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;">          ssh git@dingdingdang.online &quot;git config --global --add safe.directory /var/www/vuepress2-blog-root/&quot;</span></span>
<span class="line"><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;">          ssh git@dingdingdang.online &quot;git config --global --add receive.denyCurrentBranch ignore&quot;</span></span>
<span class="line"><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;">          git push -f git@dingdingdang.online:/var/www/vuepress2-blog-root/ static-pages</span></span>
<span class="line"><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;">          ssh git@dingdingdang.online &quot;cd /var/www/vuepress2-blog-root/  &amp;&amp; git reset --hard HEAD&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>将本地分支提交到github仓库</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#4c4f69;--shiki-dark:#E6E6E6;--shiki-light-bg:#eff1f5;--shiki-dark-bg:#222222;"><pre class="shiki shiki-themes catppuccin-latte slack-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># 添加远程地址</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">git</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> remote</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> add</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> --master</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> master</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> origin</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> git@github.com:YiguiDing/YiguiDing.github.io.git</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">git</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> add</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> .</span><span style="--shiki-light:#7C7F93;--shiki-dark:#E6E6E6;"> &amp;&amp;</span><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;"> git</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> commit</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> -m</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> &quot;update&quot;</span></span>
<span class="line"><span style="--shiki-light:#7C7F93;--shiki-light-font-style:italic;--shiki-dark:#6A9955;--shiki-dark-font-style:inherit;"># 强制推送</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#DCDCAA;--shiki-dark-font-style:inherit;">git</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> push</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> --force</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> origin</span><span style="--shiki-light:#40A02B;--shiki-dark:#CE9178;"> master</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>实现效果</strong></p><p><img src="`+t+'" alt="Alt text"></p>',16)]))}const r=i(h,[["render",k]]),g=JSON.parse('{"path":"/%E5%B7%A5%E5%85%B7/%E4%BD%BF%E7%94%A8workflows%E5%AE%9E%E7%8E%B0%E5%AF%B9vuepress%E7%9A%84%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2/","title":"使用workflows实现对vuepress的一键部署","lang":"zh-CN","frontmatter":{"title":"使用workflows实现对vuepress的一键部署","date":"2023-11-17T13:21:00.000Z","description":"使用workflows实现对vuepress的一键部署 服务端配置记录 创建git用户 为github的主机生成私钥和公钥 在github的仓库创建私钥变量 变量 名为 SSH_PRIVATE_KEY 值为 刚刚生成的私钥内容 Alt text 编写workflows配置文件 此时在该配置文件中就能通过，${{ secrets.SSH_PRIVATE_...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"使用workflows实现对vuepress的一键部署\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-11-17T13:21:00.000Z\\",\\"dateModified\\":\\"2024-03-18T08:31:16.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"丁毅桂\\",\\"email\\":\\"2449695354@qq.com\\"}]}"],["meta",{"property":"og:url","content":"https://dingdingdang.online/%E5%B7%A5%E5%85%B7/%E4%BD%BF%E7%94%A8workflows%E5%AE%9E%E7%8E%B0%E5%AF%B9vuepress%E7%9A%84%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2/"}],["meta",{"property":"og:site_name","content":"YiguiDing的Blog小站"}],["meta",{"property":"og:title","content":"使用workflows实现对vuepress的一键部署"}],["meta",{"property":"og:description","content":"使用workflows实现对vuepress的一键部署 服务端配置记录 创建git用户 为github的主机生成私钥和公钥 在github的仓库创建私钥变量 变量 名为 SSH_PRIVATE_KEY 值为 刚刚生成的私钥内容 Alt text 编写workflows配置文件 此时在该配置文件中就能通过，${{ secrets.SSH_PRIVATE_..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-18T08:31:16.000Z"}],["meta",{"property":"article:published_time","content":"2023-11-17T13:21:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-03-18T08:31:16.000Z"}],["meta",{"name":"baidu-site-verification","content":"codeva-PwE9Ts6nMl"}]]},"git":{"createdTime":1700325767000,"updatedTime":1710750676000,"contributors":[{"name":"YiguiDing","username":"YiguiDing","email":"2449695354@qq.com","commits":4,"url":"https://github.com/YiguiDing"}]},"readingTime":{"minutes":2.03,"words":608},"filePathRelative":"工具/使用workflows实现对vuepress的一键部署/index.md","excerpt":"","autoDesc":true}');export{r as comp,g as data};
