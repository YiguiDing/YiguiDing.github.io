import{_ as n,c as s,o as a,b as t}from"./app-B5jxZGJY.js";const p={},e=t(`<h1 id="express配置web服务记录" tabindex="-1"><a class="header-anchor" href="#express配置web服务记录"><span>express配置web服务记录</span></a></h1><p><code>server.js</code></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">let</span> Express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// express</span></span>
<span class="line"><span class="token keyword">let</span> connect <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;connect&quot;</span><span class="token punctuation">)</span><span class="token comment">// express 的connect 模块</span></span>
<span class="line"><span class="token keyword">let</span> vhost <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;vhost&quot;</span><span class="token punctuation">)</span><span class="token comment">// express 的 vhost 模块 子域名支持</span></span>
<span class="line"><span class="token keyword">const</span> proxy <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express-http-proxy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// express的http代理中间件</span></span>
<span class="line"><span class="token keyword">let</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// nodejs 原生http模块</span></span>
<span class="line"><span class="token keyword">let</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;https&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// nodejs 原生https模块</span></span>
<span class="line"><span class="token keyword">let</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// ---------------------------------config:https---------------------------------</span></span>
<span class="line"><span class="token keyword">const</span> host <span class="token operator">=</span> <span class="token string">&quot;0.0.0.0&quot;</span></span>
<span class="line"><span class="token keyword">const</span> port_http <span class="token operator">=</span> <span class="token number">80</span></span>
<span class="line"><span class="token keyword">const</span> port_https <span class="token operator">=</span> <span class="token number">443</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> key <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./ssl/dingdingdang.online.key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">const</span> pem <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./ssl/dingdingdang.online.pem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">key</span><span class="token operator">:</span> key<span class="token punctuation">,</span> <span class="token literal-property property">cert</span><span class="token operator">:</span> pem <span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// ---------------------------------config:https---------------------------------</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> mainApp <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> blogApp <span class="token operator">=</span> <span class="token function">Express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">&quot;./blog&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> codeApp <span class="token operator">=</span> <span class="token function">Express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">proxy</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:8080&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 由于code-server 需要使用 http://127.0.0.1:8080 还需要使用 ws://127.0.0.1:8080 所以这里的写法是不完整的</span></span>
<span class="line"><span class="token keyword">const</span> fileApp <span class="token operator">=</span> <span class="token function">Express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">proxy</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:8081&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">mainApp<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">vhost</span><span class="token punctuation">(</span><span class="token string">&quot;dingdingdang.online&quot;</span><span class="token punctuation">,</span> blogApp<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">mainApp<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">vhost</span><span class="token punctuation">(</span><span class="token string">&quot;www.dingdingdang.online&quot;</span><span class="token punctuation">,</span> blogApp<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">mainApp<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">vhost</span><span class="token punctuation">(</span><span class="token string">&quot;blog.dingdingdang.online&quot;</span><span class="token punctuation">,</span> blogApp<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">mainApp<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">vhost</span><span class="token punctuation">(</span><span class="token string">&quot;code.dingdingdang.online&quot;</span><span class="token punctuation">,</span> codeApp<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">mainApp<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">vhost</span><span class="token punctuation">(</span><span class="token string">&quot;file.dingdingdang.online&quot;</span><span class="token punctuation">,</span> fileApp<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>mainApp<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port_http<span class="token punctuation">,</span> host<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">server is running at </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>host<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>port_http<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">https<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span> mainApp<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port_https<span class="token punctuation">,</span> host<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">server is running at </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>host<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>port_https<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),o=[e];function c(i,l){return a(),s("div",null,o)}const r=n(p,[["render",c],["__file","express配置子域名和https证书.html.vue"]]),k=JSON.parse('{"path":"/%E5%90%8E%E7%AB%AF/express%E9%85%8D%E7%BD%AE%E5%AD%90%E5%9F%9F%E5%90%8D%E5%92%8Chttps%E8%AF%81%E4%B9%A6/express%E9%85%8D%E7%BD%AE%E5%AD%90%E5%9F%9F%E5%90%8D%E5%92%8Chttps%E8%AF%81%E4%B9%A6.html","title":"express配置子域名和https证书","lang":"zh-CN","frontmatter":{"title":"express配置子域名和https证书","date":"2023-04-04T05:04:00.000Z","cover":"./cover/default_cover.jpg","tag":["express"],"category":"后端","star":true,"description":"express配置web服务记录 server.js","head":[["meta",{"property":"og:url","content":"https://dingdingdang.online/%E5%90%8E%E7%AB%AF/express%E9%85%8D%E7%BD%AE%E5%AD%90%E5%9F%9F%E5%90%8D%E5%92%8Chttps%E8%AF%81%E4%B9%A6/express%E9%85%8D%E7%BD%AE%E5%AD%90%E5%9F%9F%E5%90%8D%E5%92%8Chttps%E8%AF%81%E4%B9%A6.html"}],["meta",{"property":"og:site_name","content":"YiguiDing的Blog小站"}],["meta",{"property":"og:title","content":"express配置子域名和https证书"}],["meta",{"property":"og:description","content":"express配置web服务记录 server.js"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-11-28T11:27:55.000Z"}],["meta",{"property":"article:author","content":"丁毅桂"}],["meta",{"property":"article:tag","content":"express"}],["meta",{"property":"article:published_time","content":"2023-04-04T05:04:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-11-28T11:27:55.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"express配置子域名和https证书\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-04-04T05:04:00.000Z\\",\\"dateModified\\":\\"2023-11-28T11:27:55.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"丁毅桂\\",\\"email\\":\\"2449695354@qq.com\\"}]}"],["meta",{"name":"baidu-site-verification","content":"codeva-PwE9Ts6nMl"}]]},"headers":[],"git":{"createdTime":1700226391000,"updatedTime":1701170875000,"contributors":[{"name":"YiguiDing","email":"2449695354@qq.com","commits":2}]},"readingTime":{"minutes":0.82,"words":247},"filePathRelative":"后端/express配置子域名和https证书/express配置子域名和https证书.md","localizedDate":"2023年4月4日","excerpt":"","autoDesc":true}');export{r as comp,k as data};
