var $=Object.defineProperty;var I=i=>{throw TypeError(i)};var N=(i,t,e)=>t in i?$(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var m=(i,t,e)=>N(i,typeof t!="symbol"?t+"":t,e),w=(i,t,e)=>t.has(i)||I("Cannot "+e);var s=(i,t,e)=>(w(i,t,"read from private field"),e?e.call(i):t.get(i)),r=(i,t,e)=>t.has(i)?I("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),a=(i,t,e,n)=>(w(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e),l=(i,t,e)=>(w(i,t,"access private method"),e);import{s as U,c as V,b as A,d as q,o as C,l as F,D as Y,E as _,T as j,e as v}from"./app-CeJzBNtn.js";import{H as z,a as B}from"./vidstack-Bq6c3Bam-CLO3dEM1.js";import"./vidstack-DqAw8m9J-y0Wtwbjh.js";var p,P,g,D,H;class G{constructor(t,e){r(this,g);r(this,p);r(this,P);a(this,p,t),a(this,P,e),t.textTracks.onaddtrack=l(this,g,D).bind(this),C(l(this,g,H).bind(this))}}p=new WeakMap,P=new WeakMap,g=new WeakSet,D=function(t){const e=t.track;if(!e||J(s(this,p),e))return;const n=new j({id:e.id,kind:e.kind,label:e.label??"",language:e.language,type:"vtt"});n[v.native]={track:e},n[v.readyState]=2,n[v.nativeHLS]=!0;let x=0;const E=O=>{if(e.cues)for(let b=x;b<e.cues.length;b++)n.addCue(e.cues[b],O),x++};E(t),e.oncuechange=E,s(this,P).textTracks.add(n,t),n.setMode(e.mode,t)},H=function(){s(this,p).textTracks.onaddtrack=null;for(const t of s(this,P).textTracks){const e=t[v.native]?.track;e?.oncuechange&&(e.oncuechange=null)}};function J(i,t){return Array.from(i.children).find(e=>e.track===t)}var h,T,k,S,L,y;class K{constructor(t,e){r(this,k);r(this,h);r(this,T);r(this,y,(t,e)=>{s(this,T).notify("picture-in-picture-change",t,e)});a(this,h,t),a(this,T,e),new _(t).add("enterpictureinpicture",l(this,k,S).bind(this)).add("leavepictureinpicture",l(this,k,L).bind(this))}get active(){return document.pictureInPictureElement===s(this,h)}get supported(){return A(s(this,h))}async enter(){return s(this,h).requestPictureInPicture()}exit(){return document.exitPictureInPicture()}}h=new WeakMap,T=new WeakMap,k=new WeakSet,S=function(t){s(this,y).call(this,!0,t)},L=function(t){s(this,y).call(this,!1,t)},y=new WeakMap;var d,f,c,M,R;class Q{constructor(t,e){r(this,M);r(this,d);r(this,f);r(this,c,"inline");a(this,d,t),a(this,f,e),F(t,"webkitpresentationmodechanged",l(this,M,R).bind(this))}get mode(){return s(this,c)}get supported(){return V(s(this,d))}async setPresentationMode(t){s(this,c)!==t&&s(this,d).webkitSetPresentationMode(t)}}d=new WeakMap,f=new WeakMap,c=new WeakMap,M=new WeakSet,R=function(t){const e=s(this,c);a(this,c,s(this,d).webkitPresentationMode),s(this,f).player?.dispatch(new Y("video-presentation-change",{detail:s(this,c),trigger:t})),["fullscreen","picture-in-picture"].forEach(n=>{(s(this,c)===n||e===n)&&s(this,f).notify(`${n}-change`,s(this,c)===n,t)})};var o;class W{constructor(t){r(this,o);a(this,o,t)}get active(){return s(this,o).mode==="fullscreen"}get supported(){return s(this,o).supported}async enter(){s(this,o).setPresentationMode("fullscreen")}async exit(){s(this,o).setPresentationMode("inline")}}o=new WeakMap;var u;class X{constructor(t){r(this,u);a(this,u,t)}get active(){return s(this,u).mode==="picture-in-picture"}get supported(){return s(this,u).supported}async enter(){s(this,u).setPresentationMode("picture-in-picture")}async exit(){s(this,u).setPresentationMode("inline")}}u=new WeakMap;class st extends z{constructor(e,n){super(e,n);m(this,"$$PROVIDER_TYPE","VIDEO");m(this,"airPlay");m(this,"fullscreen");m(this,"pictureInPicture");U(()=>{if(this.airPlay=new B(e,n),V(e)){const x=new Q(e,n);this.fullscreen=new W(x),this.pictureInPicture=new X(x)}else A(e)&&(this.pictureInPicture=new K(e,n))},this.scope)}get type(){return"video"}setup(){super.setup(),q(this.video)&&new G(this.video,this.ctx),this.ctx.textRenderers.attachVideo(this.video),C(()=>{this.ctx.textRenderers.attachVideo(null)}),this.type==="video"&&this.ctx.notify("provider-setup",this)}get video(){return this.media}}export{st as VideoProvider};
