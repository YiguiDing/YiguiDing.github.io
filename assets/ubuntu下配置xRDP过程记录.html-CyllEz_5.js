import{_ as s,c as n,o as e,b as a}from"./app-DjDtDPYL.js";const i={},l=a(`<h1 id="ubuntu下配置xrdp过程记录" tabindex="-1"><a class="header-anchor" href="#ubuntu下配置xrdp过程记录"><span>ubuntu下配置xRDP过程记录</span></a></h1><h2 id="xrdp" tabindex="-1"><a class="header-anchor" href="#xrdp"><span>xRDP</span></a></h2><ul><li>RDP是windows系统下默认的远程桌面协议 默认端口3389</li><li>VNC是linux系统下默认的远程桌面协议 默认端口5900</li><li><strong>xRDP</strong>是RDP的开源版本 <ul><li>安装xRDP的linux可以通过windows原生的远程桌面连接程序MSTSC建立远程连接，</li><li>于是市面上一系列用于远程登录windows的手机端app和PC端应用程序也可用于登陆linux</li></ul></li></ul><h2 id="通过命令安装" tabindex="-1"><a class="header-anchor" href="#通过命令安装"><span>通过命令安装</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span>  xrdp</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="添加用户到组" tabindex="-1"><a class="header-anchor" href="#添加用户到组"><span>添加用户到组</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">默认情况下，Xrdp 使用 /etc/ssl/private/ssl-cert-snakeoil.key 仅“ssl-cert” 用户组可读</span>
<span class="line"><span class="token function">sudo</span> adduser 用户名 ssl-cert</span>
<span class="line">或</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">usermod</span> 用户名 <span class="token parameter variable">-G</span> ssl-cert</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置服务" tabindex="-1"><a class="header-anchor" href="#配置服务"><span>配置服务</span></a></h2><p><strong>配置文档/etc/xrdp/xrdp.ini</strong><br> xrdp.ini 关键部分在globals</p><div class="language-conf line-numbers-mode" data-highlighter="prismjs" data-ext="conf" data-title="conf"><pre><code><span class="line">[globals]</span>
<span class="line">bitmap_cache=yes       #位图缓存</span>
<span class="line">bitmap_compression=yes #位图压缩</span>
<span class="line">port=3389              #监听端口</span>
<span class="line">crypt_level=low        #加密程度（none为不加密 low为40位，默认为high 128位，medium为双40位）</span>
<span class="line">channel_code=1         #????</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>配置文档/etc/xrdp/sesman.ini</strong></p><div class="language-conf line-numbers-mode" data-highlighter="prismjs" data-ext="conf" data-title="conf"><pre><code><span class="line">[Globals]</span>
<span class="line">ListenAddress=127.0.0.1      #监听ip地址(默认即可)</span>
<span class="line">ListenPort=3350              #监听端口(默认即可)</span>
<span class="line">EnableUserWindowManager=1    #1为开启,可让用户自定义自己的启动脚本</span>
<span class="line">UserWindowManager=startwm.sh</span>
<span class="line">DefaultWindowManager=startwm.sh</span>
<span class="line"> </span>
<span class="line">[Security]</span>
<span class="line">AllowRootLogin=1              #允许root登陆</span>
<span class="line">MaxLoginRetry=4               #最大重试次数</span>
<span class="line">TerminalServerUsers=tSUSErs   #允许连接的用户组(如果不存在则默认全部用户允许连接)</span>
<span class="line">TerminalServerAdmins=tsadmins #允许连接的超级用户(如果不存在则默认全部用户允许连接)</span>
<span class="line"> </span>
<span class="line">[Sessions]</span>
<span class="line">MaxSessions=10           #最大会话数</span>
<span class="line">KillDisconnected=0       #是否立即关闭断开的连接(如果为1,则断开连接后会自动注销)</span>
<span class="line">IdleTimeLimit=0          #空闲会话时间限制(0为没有限制)</span>
<span class="line">DisconnectedTimeLimit=0  #断开连接的存活时间(0为没有限制)</span>
<span class="line"> </span>
<span class="line">[Logging]</span>
<span class="line">LogFile=./sesman.log     #登陆日志文件</span>
<span class="line">LogLevel=DEBUG           #登陆日志记录等级(级别分别为,core,error,warn,info,debug)</span>
<span class="line">EnableSyslog=0           #是否开启日志</span>
<span class="line">SyslogLevel=DEBUG        #系统日志记录等级</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="启动服务" tabindex="-1"><a class="header-anchor" href="#启动服务"><span>启动服务</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> xrdp</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">service</span> xrdp start</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="构建、编译、安装-pulseaudio-模块-实现音频重定向" tabindex="-1"><a class="header-anchor" href="#构建、编译、安装-pulseaudio-模块-实现音频重定向"><span>构建、编译、安装 pulseaudio 模块 实现音频重定向</span></a></h2><p>data：2022-08-15<br><strong>获得的构建文件</strong><br> 根据官方wiki文章<a href="https://github.com/neutrinolabs/pulseaudio-module-xrdp/wiki/Build-on-Debian-or-Ubuntu" target="_blank" rel="noopener noreferrer">《Build-on-Debian-or-Ubuntu（在 Debian 或 Ubuntu 上构建）》</a>可知，<strong>获得的文件构建</strong>有<strong>两种方式</strong>，</p><ul><li>一种是从 pulseaudio 服务器构建中提取内部开发文件，或执行脚本 『暂不使用这种方式』</li><li>另一方种方式是直接下载已经构建好的文件<a href="https://github.com/lnee94/pulseaudio-headers-xrdb/releases/tag/v1.0" target="_blank" rel="noopener noreferrer">pulseaudio-headers-xrdb</a>并通过命令安装<code>pkg -i pulseaudio-headers-xrdb.deb</code>,将会解压到目录<code>/opt/pulseaudio-headers-xrdb/</code></li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token builtin class-name">cd</span> ~</span>
<span class="line"><span class="token function">wget</span> https://github.com/lnee94/pulseaudio-headers-xrdb/releases/download/v1.0/pulseaudio-headers-xrdb.deb</span>
<span class="line">pkg <span class="token parameter variable">-i</span> pulseaudio-headers-xrdb.deb</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>编译 xrdp pulseaudio 模块</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 编译构建 pulseaudio 模块本身需要一些构建工具和包开发工具</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> build-essential dpkg-dev libpulse-dev <span class="token function">git</span> autoconf libtool</span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">cd</span> ~</span>
<span class="line"><span class="token function">git</span> clone https://github.com/neutrinolabs/pulseaudio-module-xrdp.git</span>
<span class="line"><span class="token builtin class-name">cd</span> pulseaudio-module-xrdp</span>
<span class="line"></span>
<span class="line">./bootstrap <span class="token operator">&amp;&amp;</span> ./configure <span class="token assign-left variable">PULSE_DIR</span><span class="token operator">=</span>/opt/pulseaudio-headers-xrdb/</span>
<span class="line"><span class="token function">make</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>安装 xrdp pulseaudio 模块</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token builtin class-name">cd</span> pulseaudio-module-xrdp</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 该命令执行后，</span></span>
<span class="line"><span class="token comment"># 构建的模块将被安装在正确的目录</span></span>
<span class="line"><span class="token comment"># 同时：a script load_pa_modules.sh to load the modules when a session is started. On many systems this script is installed by default in /usr/libexec/pulseaudio-module-xrdp/</span></span>
<span class="line"><span class="token comment"># 同时：Install a desktop file pulseaudio-xrdp.desktop which will call the load_pa_modules.sh script when a desktop is loaded. On many systems this script is installed by default in /etc/xdg/autostart</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>确认是否安装成功</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">ls $(pkg-config --variable=modlibexecdir libpulse) | grep xrdp</span>
<span class="line"># 输出结果中应当包含</span>
<span class="line"># module-xrdp-sink.so</span>
<span class="line"># module-xrdp-source.so</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,24),t=[l];function d(p,r){return e(),n("div",null,t)}const o=s(i,[["render",d],["__file","ubuntu下配置xRDP过程记录.html.vue"]]),u=JSON.parse('{"path":"/%E5%90%8E%E7%AB%AF/ubuntu%E4%B8%8B%E9%85%8D%E7%BD%AExRDP%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/ubuntu%E4%B8%8B%E9%85%8D%E7%BD%AExRDP%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95.html","title":"ubuntu下配置xRDP过程记录","lang":"zh-CN","frontmatter":{"title":"ubuntu下配置xRDP过程记录","date":"2022-08-11T22:55:00.000Z","cover":"./cover/default_cover.jpg","tag":["ubuntu","xRDP"],"category":"笔记","description":"ubuntu下配置xRDP过程记录 xRDP RDP是windows系统下默认的远程桌面协议 默认端口3389 VNC是linux系统下默认的远程桌面协议 默认端口5900 xRDP是RDP的开源版本 安装xRDP的linux可以通过windows原生的远程桌面连接程序MSTSC建立远程连接， 于是市面上一系列用于远程登录windows的手机端app和...","head":[["meta",{"property":"og:url","content":"https://dingdingdang.online/%E5%90%8E%E7%AB%AF/ubuntu%E4%B8%8B%E9%85%8D%E7%BD%AExRDP%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/ubuntu%E4%B8%8B%E9%85%8D%E7%BD%AExRDP%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95.html"}],["meta",{"property":"og:site_name","content":"YiguiDing的Blog小站"}],["meta",{"property":"og:title","content":"ubuntu下配置xRDP过程记录"}],["meta",{"property":"og:description","content":"ubuntu下配置xRDP过程记录 xRDP RDP是windows系统下默认的远程桌面协议 默认端口3389 VNC是linux系统下默认的远程桌面协议 默认端口5900 xRDP是RDP的开源版本 安装xRDP的linux可以通过windows原生的远程桌面连接程序MSTSC建立远程连接， 于是市面上一系列用于远程登录windows的手机端app和..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-11-17T13:06:31.000Z"}],["meta",{"property":"article:author","content":"丁毅桂"}],["meta",{"property":"article:tag","content":"ubuntu"}],["meta",{"property":"article:tag","content":"xRDP"}],["meta",{"property":"article:published_time","content":"2022-08-11T22:55:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-11-17T13:06:31.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"ubuntu下配置xRDP过程记录\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-08-11T22:55:00.000Z\\",\\"dateModified\\":\\"2023-11-17T13:06:31.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"丁毅桂\\",\\"email\\":\\"2449695354@qq.com\\"}]}"],["meta",{"name":"baidu-site-verification","content":"codeva-PwE9Ts6nMl"}]]},"headers":[{"level":2,"title":"xRDP","slug":"xrdp","link":"#xrdp","children":[]},{"level":2,"title":"通过命令安装","slug":"通过命令安装","link":"#通过命令安装","children":[]},{"level":2,"title":"添加用户到组","slug":"添加用户到组","link":"#添加用户到组","children":[]},{"level":2,"title":"配置服务","slug":"配置服务","link":"#配置服务","children":[]},{"level":2,"title":"启动服务","slug":"启动服务","link":"#启动服务","children":[]},{"level":2,"title":"构建、编译、安装 pulseaudio 模块 实现音频重定向","slug":"构建、编译、安装-pulseaudio-模块-实现音频重定向","link":"#构建、编译、安装-pulseaudio-模块-实现音频重定向","children":[]}],"git":{"createdTime":1700226391000,"updatedTime":1700226391000,"contributors":[{"name":"YiguiDing","email":"2449695354@qq.com","commits":1}]},"readingTime":{"minutes":3.04,"words":912},"filePathRelative":"后端/ubuntu下配置xRDP过程记录/ubuntu下配置xRDP过程记录.md","localizedDate":"2022年8月11日","excerpt":"","autoDesc":true}');export{o as comp,u as data};
