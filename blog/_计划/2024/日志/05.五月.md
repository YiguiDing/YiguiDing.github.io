---
title: 2024年五月日志
date: 2024-04-01
cover: ./cover/我要向前走.png
category: to-do-list
tag: [to-do-list]
article: false
---


五月一日，周三，睡到下午一点起床，学习stm32输入捕获功能，听不进去，摆烂，然后刷哔哩哔哩，看了解说版的半部剧，到凌晨，然后又接着继续学了几个小时，到第二天早上五点五十，内容包括输入捕获电路工作原理，配置过程，主模式、从模式、触发源选择，测频率的原理和方法，测占空比的原理和方法。

五月二日，周四，睡到下午两点左右，然后起床拿快递，买到3d光固化打印机到了，组装贴膜然后吃饭，然后收拾房间，太乱了。然后找了个模型，把零件模型调整位置做支撑，尝试打印，然后摆烂刷视频，到凌晨两点半... 

五月三日，周五，睡到下午一点 起床收拾打印好的东西，回收打印材料 拆支撑 清理擦拭设备 酒精清洗打印件 打磨 紫外线二次加固 太麻烦了 忙到吃饭 然后又摆烂到八点半，然后尝试编程实现定时器测频和测占空比 期间 找合适尺寸的锂电池 了解常用升压芯片和经典电路 了解NPU芯片原理和本质 看解说版大明王朝 一直到早上九点睡觉

五月四日 周六 睡到下午五点 吃个饭 几乎啥也没干摆烂到 晚上九点 学习定时器编码器接口 实现通过定时器编码器接口测位置和测速；通过逆克拉克变换和帕克变换实现foc的开环速度控制 到第二天下午两点，太困了 睡觉

五月五日 周日 睡到晚上八点 然后九点开始继续看foc相关内容 学习位置闭环 了解磁编码器、高频注入等判断电机位置的方式，尝试通过定时器中断实现毫秒级时钟，修改速度开环控制代码、通过定时器编码器接口实现对速度的调节 到第二天凌晨五点半。

五月六日 周一 接上一天 没睡觉 吃个饭 看了点王阳明心学 九点到公司上班 写了点代码 熬到下班 回家吃饭 然后睡觉

五月七日 周二 凌晨三点睡醒 找回中信证券交易密码 淘宝找合适的铷磁铁 内径2mm 外5 高1mm 径向冲磁 还有as5600模块 然后简略看了下文档 估计了下尺寸 到早上七点 然后上一天班 下班回家吃饭直接睡觉

五月八日 上一天班 解决了全覆盖算法问题  然后下班回家吃饭睡觉 直接到第二天早上

五月九日 周四 上一天班，解决了全覆盖算法中的两个小问题 然后下班回家吃饭睡觉 直接到第二天早上九点

五月十日 周五 上班 通过百度地图中的多边形和线实现全覆盖算法 下班回家 几乎啥也没干 睡觉

五月十一日，周六，上班，摆烂一天，

五月十二日，周日，放假，睡到上午十点，学了ADC相关内容，做了笔记，晚上很晚睡。

五月十三日，周一，上班，摆烂一天。

五月十四日，周二，上班，大致实现了路径规划界面和软件架构，下班回家完成了stm32 ADC外设测电压程序的编写 凌晨两点睡觉

五月十五 周三 上班 软件界面优化 下班回家吃饭然后把大明王朝大部分内容看完了 又浪费了两个小时的时间 凌晨四点半睡觉

五月十六 周四 十点上班 敲代码 软件界面优化 下班吃饭摆烂到凌晨三四点

五月十七 周五 十点去多上班 几乎摆烂一天 焊了几块板子 下班回家吃饭 摆烂到凌晨两点

五月十八 周六 睡到下午两点 学习stm32 adc 实现软件触发单次转换非扫描模式 和 软件触发连续转换非扫描模式的案例代码 尝试编写极简版todolist 到现在第二天早上六点半

五月十九日 周日 睡到下午五点 继续尝试编写极简版todolist 一晚上没睡 

到第二天二十号 周一 早上去上班 写代码合并全覆盖的新功能代码 下午跑到隔壁未出租的房间地板睡了一个小时  晚上下班回家吃过饭后直接睡觉 

到第二天二十一号 周二 早上去上班 几乎啥也没干 摆烂一天回家 又摆烂一晚上 到现在凌晨一点四十

五月二十二日 星期三，今天上班 学了react基本语法 学了react native 的基本概念 编写了一些测试代码 晚上回家学了点stm32

> 废物，时间都花到什么地方了？

五月二十三 周四 继续学习react native技术测试react native windows技术 尝试编写mavlink 测试代码 测试其如何运行在web socket之上 晚上回家看了点stm32 dma相关内容

五月二十四 周五 研究mavlink官方js库的生成器 尝试把生成的js库中对node的依赖 如EventEmiter Buffer Utils  crypto都替换成纯js依赖 然后移植到react native中运行 实测可行 然后研究react- native-tcp的相关库 尝试解决运行报错 下班回家后继续尝试编写todo list-react 为实现对json文件统一的增删改查操作，尝试编写`Mapper<Common>`类 用来包装LowDB类，然后继续学习react 主要是react类风格的组件的范型 以及 编程范式，尝试编写嵌套组件 看文档并实践学习react-router和react- sortablejs的使用 实现排序操作 到现在洗漱完 凌晨三点半

五月二十五 周六 上午十点睡醒 继续写代码实现todo list-react 编写代码实现dma搬运内存数据 凌晨五点半睡觉

五月二十六 周日 下午三点睡醒 学习是他们32 dma 编写代码实现AD规则组多通道扫描模式连续触发 配合 DMA硬件触发 自动重装 循环模式 实现将AD转换结果搬运至内存，然后学习串口通信的内容，继续编写todo list native的代码 到凌晨三点四十准备睡觉

五月二十七 周一 早上七点才睡着 上午十点多睡醒 十一点到公司 主要把js mavlink再次研究了下 发现其依赖buffer utils events 都有同名的浏览器版的npm包 crypto没有同名的包 而是crypto-browserify 另外可能在依赖的包underscore中间接依赖了stream 所以不得不再rn项目根目录中通过rn-nodeify —install stream —hack安装 stream   另外了解到要安装tcp这些项目可能不能用Expo这样的框架 ，否则会报错，开源社区里暂时没找到解决方法，所以不使用框架重新新建了项目 下班回家吃饭后尝试给自己电脑装开发环境，装好之后就睡着了，凌晨三点被蚊子咬醒，点蚊香 玩了会儿手机就到现在快五点了。现在准备解决tcp依赖的问题 然后学stm32.

五月二十八日 周二 早上五点起床 解决react-native-tcp- socket的报错 主要原因可能是因为min sdk version不是21 而且之前使用了exp框架 还用rn-nodeify安装了一堆东西，这些可能都是不能运行的原因。然后把三月到五月的日志整理了下，写成markdown；然后吃早饭，上班，准备集成地图库，由于官方文档推荐的react- native-maps默认使用谷歌地图，而经过尝试使用高德地图的react- native-amap3d库，无法使用，引入后没有报错，但也不显示地图，翻看issue发现同样的问题，而且该库是由个人开发者维护，更新维护不频繁，example无法运行，star不高issue太多，最新能够兼容的版本是rn0.71.2 而rn版本最新为0.74.1，所以选择了另一个库mapbox/maps，这个库的地图精美，维护频繁 star数2k 比之前两个项目都要高，star数高 issue少，安装引用后无任何报错，比较完美，决定采用，目前主要完成了账号注册，key申请和配置 地图语言本地化跟随系统，地图样式的切换（主要是卫星地图）这些，下班回家吃饭后，后看了几集RN 的课程，主要看了一些基本概念，都是官方文档里的内容，然后睡着了 睡到凌晨两点醒。

五月二十九 早上凌晨两点半点左右起床 洗漱吃饭然后学习stm32串口通信相关内容，看完了原理介绍和编程实现，然后睡着了，睡到早上八点半起床去上班 主要是在了解react中如何实现全局的响应式状态管理，期望实现vue中的reactive效果 也就是export const state =reactive(new Obj())类似这样的简易状态管理，react官方的状态管理不是很好，要不然要不然开源社区也不会有那么多第三方的响应式状态管理库，了解下来发现有个叫mobx的状态管理库，好像是基于proxy的，写了个案例试了，表现还行。然后找了几个图标库，最后发现react- native- vector-icons这个库非常不错，内置了多个图标库，star数17k，文档完善，非常好用；然后挑了几个来实现了软件状态栏，然后尝试写了下ROVDriver驱动，主要是写了断开自动重连、指数退避策略、主循环，发送心跳包的逻辑，状态属性的定义 这些。然后尝试集成react- joystick- component这个库，结果发现这个好像是网页版的，然后又尝试react- native-joystick这个库，结果报错，下班后，查文档发现这个库依赖于react- native- gesture- handler这个库，报错也和这个有关，查其文档发现对kotlin版本有要求，还要求在组件入口用<GestureHandlerRootView> or gestureHandlerRootHOC.组件包裹所有内容，按照文档中给的案例代码写了demo，测试可用，然后又试了之前的joystick，也可以运行了，但是有点卡，看了源代码发现用的是给View修改style属性来实现的，而react- native- gesture- handler这个库的案例代码的完整写法会使用一个叫react- native- reanimated的库，专门做动画的，效果应该不错，尝试写了demo，解决了一些报错，其中好像又个报错还和minsdk version有关，弄了很久，终于可以用了，效果确实比joystick要好，流畅，于是准备用reanimated技术自己写一个joystick，写到一两点，中间尝试解决了各种报错和算法问题，比如计算拖拽后按钮的位置，需要把拖拽的位置看成向量，先对向量归一化，然后缩放到按钮半径的长度，此时向量的x和y就是按钮位置的最大值或最小值，不能超过这个范围，这样摇杆才会被限制在圆形范围中，而不是方型范围中。然后尝试把写的joystick应用到业务代码中，出现了不能在UI线程中调用同步代码的报错，需要调用RunOnJs ，然后后来还碰到了Maximum update depth exceeded'的报错，应该是响应式状态管理的问题，写法不对，明天再说，然后洗漱 吃饭 写日志，到现在凌晨3:05

五月三十日 周四 上班 尝试解决响应式的报错：Maximum update depth exceeded.要使用：action(()=>{})；测试react-native-vlc-media-player库并集成；实现设置界面的交互逻辑，实现通信、视频的配置界面。 凌晨两点半睡觉

五月三十一日 周五 上班 实现地图设置页面 实现地图类型切换功能 离线地图功能
