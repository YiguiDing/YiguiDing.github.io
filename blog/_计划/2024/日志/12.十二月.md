---
title: 2024年十二月日志
cover: ./cover/我要向前走.png
category: to-do-list
tag: [to-do-list]
article: false
---

十二月一日 周日 忘了干啥了 反正没学什么东西 晚上跑步

十二月二日 周一至周三，摸鱼，不知道干了什么，晚上跑步

十二月五日 周四至周五 调休两天 在家 浪费时间 啥也没干 晚上跑步

十二月七日 周六 啥也没干 浪费时间 晚上跑步。

十二月十五日 周日 蛤 干啥了？ 发现了as5600输出不连续的问题，尝试解决 开始是怀疑芯片坏了，换后问题依旧，还怀疑过电机，没查出原因 晚上跑步3km

十二月十六日 周一 上班 上午没摸鱼 写代码 把protocolManager删掉了 重构，下午在了解高频注入的理论内容，因为昨天已经尝试着实现了，但是波形噪音很大，用的是直接用arctan算角度，今天发现应当用外差法算误差角，作为鉴相器，然后用锁相环得到实际位置，晚上下班后尝试实现，效果不好，可能是整个循环耗时太高了，测试了下所有比较耗时的函数的具体耗时情况，存在很多可以优化的地方，然后原本尝试用simplefoc驱动跑一下，然后测下循环耗时，结果发现了as5600输出不连续是个常见问题，然后尝试着把昨天的问题解决了，没跑步，零点半准备洗漱

十二月十七日 周二 上班 因为现在有感foc算法的的问题基本都解决了，打算以此为项目实践 尝试画一块云台电机foc驱动板 上午下午 查芯片文档 画原理图 下班回家后布线 弄了半天发现板子尺寸错了 改了重新画弄到凌晨两点 洗漱下 吃个饭 到凌晨三点半 今天没跑步。

周三 上班 又调整布局、删减电容电阻，重新画了两遍 晚上跑步 弄到凌晨三点 准备睡觉

周四 上班 重画 第三遍 改用qfn封装 周五又改用f301重画 封装改用0402 磁传感器和检流电阻也改用qfn封装，弄到凌晨三点 这几天其实学到很东西 线宽 过孔 走线 敷铜之类的 至少每次重画都比上一次熟练

周六 睡到下午一点起床 尝试着画了下另外一块板子 平衡小车腿上的电机的位置检测板，还没想好具体方案，晚上不知道在干啥.浪费一晚上时间


十二月二十二日 周日 前晚凌晨三四点睡 睡到下午三四点 起床收拾房间 晚上好像也是啥也没干...

十二月二十三日 周一 正常上班 写了点代码 然后摸鱼 学了点电路原理 回家吃晚饭就睡 睡到十一点半 起床到凌晨两点 准备睡觉。

这样下去人会废掉的

周六12月28号 上午七点二十出门 练车 中午回家 尝试用c语言完全重写foc驱动 目前完成了 开环电压闭环位置控制 实现了foc pll pid lpf 发现了analogread和analogwrite耗时严重的问题。凌晨十二点半准备睡觉


12月 29号 周日 睡到中午 起床洗漱吃饭 继续尝试写新版foc驱动 尝试解决analogread analog write耗时严重的问题 尝试使用 uno r4芯片的底层标准库实现，目前成功实现了adc_init和gpt_init，即adc和pwm模块的初始化，中途打算尝试用stm32f411的开发版来解决，实际跑了下电流环代码耗时100us左右，还是比较耗时，可能还是需要对analogwrite函数优化，但是该arduino库是基于hal库实现的，不是标准库，并且后续打算使用f301芯片实现，所以放弃尝试，转而继续尝试在unor4上进行优化。弄到凌晨两点，准备睡觉


十二月三十号 周一上班 继续写代码重构上位机 晚上回家继续写foc驱动，尝试用底层库实现pwm输出，弄到凌晨两点半都没弄好...

